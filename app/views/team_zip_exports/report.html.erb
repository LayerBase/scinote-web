<html>
  <head>
    <meta charset="utf-8">
    <style type="text/css">
      <%= Rails.application
               .assets_manifest
               .find_sources('application.css')
               .first
               .to_s
               .force_encoding(Encoding::UTF_8)
               .html_safe %>
    </style>

    <script type="text/javascript">
      <%= raw Rails.application.assets['handsontable.full.min.js'].to_s %>
    </script>

    <!-- Libraries for formulas -->
    <script type="text/javascript">
      <%= raw Rails.application.assets['lodash.js'].to_s %>
    </script>
    <script type="text/javascript">
      <%= raw Rails.application.assets['numeral.js'].to_s %>
    </script>
    <script type="text/javascript">
      <%= raw Rails.application.assets['numeric.js'].to_s %>
    </script>
    <script type="text/javascript">
      <%= raw Rails.application.assets['md5.js'].to_s %>
    </script>
    <script type="text/javascript">
      <%= raw Rails.application.assets['jstat.js'].to_s %>
    </script>
    <script type="text/javascript">
      <%= raw Rails.application.assets['formula.js'].to_s %>
    </script>
    <script type="text/javascript">
      <%= raw Rails.application.assets['parser.js'].to_s %>
    </script>
    <script type="text/javascript">
      <%= raw Rails.application.assets['ruleJS.js'].to_s %>
    </script>
    <script type="text/javascript">
      <%= raw Rails.application.assets['handsontable.formula.js'].to_s %>
    </script>
    <script type="text/javascript">
      <%= raw Rails.application.assets['big.min.js'].to_s %>
    </script>

    <!-- Init Handsontables -->
    <script>
      window.onload = function() {
        var tables = document.getElementsByClassName('hot-table-container');
        var tableVals = document.getElementsByClassName('hot-table-contents');

        for (i = 0; i < tables.length; i++) {
          tables[i].innerHTML=''
          new Handsontable(tables[i], {
              data: JSON.parse(tableVals[i].value).data,
              rowHeaders: true,
              colHeaders: true,
              filters: true,
              dropdownMenu: true,
              formulas: true
          });
        }
      };
    </script>

    <title><%= title %></title>
  </head>
  <body class='print-report-body'>
    <div class='print-report'>
      <%= content.force_encoding(Encoding::UTF_8).html_safe %>
    </div>
  </body>
</html>
